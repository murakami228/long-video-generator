# スクリプト生成ルール (Script Generation Rules)

このドキュメントでは、`input.json` を作成する際のルールについて説明します。

## 1. テロップ（字幕）のルール

### 文字数制限
- **1つのセクションにつき、テロップは1行以内**に収めることを目安とします。
- **推奨文字数**: 約35文字以内
  - 画面下部に表示される字幕エリア（黒背景）に収まる長さを想定しています。
  - 長すぎる場合は、セクションを分割するか、要約して短くしてください。

### 強調表示（ハイライト）
- 重要な単語やフレーズを**黄色**で強調表示できます。
- `input.json` の各セクションに `highlight` フィールドを追加し、強調したい単語の配列を指定します。

**例:**
```json
{
    "id": "step1",
    "text": "運送業の許可を取得するには、最低でも600万円から1500万円程度の自己資金が必要です。",
    "highlight": ["600万円", "1500万円", "自己資金"],
    "step": true
}
```

## 2. デザイン・制作ワークフロー (NEW)

### 工程の分離
1.  **Scripting Phase (原稿作成)**: `input.json` のテキスト作成に集中します。この段階ではデザインを意識せず、構成と文章を固めます。
2.  **Visual Design Phase (デザイン作成)**: 原稿が固まった後、プロジェクトのテーマに合わせてデザインを決定します。
    - **Default Templateの禁止**: 安易に既存テンプレート (`01_std_list` 等) を適用せず、そのプロジェクトに最適なデザイン（配色、フォント、レイアウト）を個別に設計します。
3.  **Validation Phase (自動チェック)**: ビルド前に `validate_input.ts` を実行し、ルール違反がないか確認します。

### アイコンフォントの利用
- Google Material Symbols を使用する場合、CSSクラスに必ず正しい `font-family` を指定してください。
- `validate_input.ts` がこの設定漏れを自動検出します。

```css
.material-symbols-outlined {
    font-family: 'Material Symbols Outlined';
    /* ... other properties ... */
}
```

## 3. バリデーションチェック

`scripts/validate_input.ts` を実行することで、文字数超過やCSS設定ミスなどのルール違反を自動的にチェックできます。

```bash
npx tsx scripts/validate_input.ts <project_slug>
```

- **CSS Check**: CSSファイルの存在確認、アイコンフォント定義の整合性チェックを行います。
- **Text Check**: 35文字制限、禁則文字、音声テキストの整合性などをチェックします。

## 4. ナレーションとテロップの整合性

### 内容の一致
- **`text`（テロップ）と `speechText`（音声）は、原則として内容を一致させる**必要があります。
- 視聴者が耳で聞く情報と目で見る情報に乖離があると、認知負荷が高まり動画の質が低下します。

### speechText（読み上げ）の工夫
- **句読点の制限**: 音声の不自然な途切れを防ぐため、1つのセクション内の句読点（、。）は**原則2個以下**に抑えてください。
- **連続句読点の禁止**: `、、` や `。。` のように句読点を連続させることは、長い無音時間を生むため禁止です。
- **英字表記の許容**: `FX` や `SNS` などの一般的な英字表記はそのまま使用可能です（バリデータでは警告が出ますが、許容されます）。

## 5. 動画構成のルール
- **構成の柔軟性**: 以前は「6ステップ構造」を推奨していましたが、現在は柔軟な構成が可能です。
- ストーリーの流れに合わせて、必要なセクション数を自由に設定してください。

## 6. 修正指示のワークフロー

### 番号付きインデックスリストの活用
- **AI側**: 動画の生成後や修正が必要な際、各セクションに番号を振った「インデックスリスト」を提示します。
- **ユーザー側**: 提示された番号（例：「#3のタイミングを遅らせて」「#5のテキストを修正」）を使って指示を出すことで、正確かつ迅速な修正が可能になります。

## 7. ステップ制御 (Step Control) (NEW)

スライド内の要素をアニメーションで順次表示させるための `step` フラグの設定ルールです。
スクリプト生成時（AI）は、以下のロジックに従って `true/false` をインテリジェントに判断してください。

### 基本方針
単に「すべてのセクションで `step: true`」とするのは**禁止**です。文脈に応じて判断します。

| 文脈・内容 | 設定 | 理由 |
| :--- | :--- | :--- |
| **Intro / Title** | `step: false` | スライドの導入部。まだ具体的な項目を表示せず、タイトルや背景のみを見せるため。 |
| **New Item (List/Flow)** | `step: true` | 「1つ目は〜」「次に〜」など、新しい要素が登場するタイミングで表示を進めるため。 |
| **Detail / Support** | `step: false` (or `true`) | 直前に出した項目の補足説明の場合、表示状態を維持したいなら `false`。新しい詳細を出すなら `true`。 |
| **Warning / Result** | `step: true` | 結論や警告をドンと出すタイミング。 |

### 注意点
- `step: false` を設定した場合、スライドは**「前のステップの状態」を維持**します（要素が消えることはありません）。
- スライドの項目数（例: 3つの要素）と、`step: true` の回数（例: 3回）が一致するように調整してください。

